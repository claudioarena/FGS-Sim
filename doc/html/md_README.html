<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>FGS-Sim: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FGS-Sim
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Simulation of the Twinkle Fine Guidance System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_README.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>FGS-Sim</h1>
<h2>Centroid determination simulation</h2>
<p>Feiyu Fang</p>
<p>Twinkle FGS-Sim summer project, July 2017: Finding the centroid of a defocussed star to sub-pixel accuracy</p>
<h2>Changelog</h2>
<p>Version number, Date in ISO 8601 format, Notes on changes</p>
<ul>
<li>1.0. 2017-07-12, Initial version.</li>
<li>1.1. 2017-07-16, Fixed x-axis incorrect determination in findCentroid method in <a class="el" href="_test_8cpp.html" title="Bin an inputted Gaussian 2d array and find its centroid. ">Test.cpp</a></li>
<li>1.2. 2017-07-17, Changed binData method in <a class="el" href="_test_8cpp.html" title="Bin an inputted Gaussian 2d array and find its centroid. ">Test.cpp</a> to use int instead of float, representing quantised photon counts</li>
<li>1.3. 2017-07-18, Added option for using Poission noise, using an inputted SNR and sigma.</li>
<li>2.0.0. 2017-07-20.<ul>
<li>Moved the main method of <a class="el" href="_main_8cpp.html" title="Main method to run centroid recovery simulation. ">Main.cpp</a> into void run() in <a class="el" href="_test_8cpp.html" title="Bin an inputted Gaussian 2d array and find its centroid. ">Test.cpp</a> to plot graphs of multiple results with loops in <a class="el" href="_main_8cpp.html" title="Main method to run centroid recovery simulation. ">Main.cpp</a>.</li>
<li>Added capability in Main to create a CSV of results out of a loop for graphs</li>
</ul>
</li>
<li>2.0.1-noise-testing. 2017-07-26.<ul>
<li>Many bug fixes and performance improvements.</li>
<li>Changed the noise addition to Poisson noise as X~Po(sqrt(N)).</li>
<li>Added integration time and telescope aperture as parameters; both currently set to 1 until the photon-magnitude relation is added.</li>
<li>Started Git sync for version control</li>
<li>Created Doxygen documentation and experimental Makefile</li>
<li>Tested whether it makes a difference if Poisson noise is calculated before binning into pixels (and then combining as RMS) or after binning. Result: <div class="image">
<img src="http://i.imgur.com/AN4TjMR.png"  alt="The results are different" title="Results"/>
</div>
 The input Gaussian was kept the same by using the same seed for generating Poisson random variables both before and after passing the data through the binData function. The resulting noise is different.</li>
<li>Changed relevant functions in <a class="el" href="class_test.html" title="Class to bin an inputted Gaussian 2d array and find its centroid. ">Test</a> class from non-static to static to allow the above testing.</li>
<li>Uniform distribution was added to vary the starting centre point of a simulated star.</li>
<li>The input and output coordinates have been changed to refer to pixel coordinates instead of the arbitrary 0-1-2 original coordinate system, although the <a class="el" href="class_gauss2d.html">Gauss2d</a> class still generates a Gaussian with mean 1 for now.</li>
</ul>
</li>
<li>2.1.0 2017-07-28.<ul>
<li>Rewrote <a class="el" href="class_gauss2d.html">Gauss2d</a> class to generate a 2d array of integers to allow simulation of the defocussing of N photons into a Gaussian. Also resulted in much more efficient code, with the simulation running ~4x faster with excellent accuracy.</li>
<li>Used Claudio's Google Sheet to convert stellar magnitudes into photons s^-1 m^-2 to have a stellar magnitude input in <a class="el" href="_main_8cpp.html" title="Main method to run centroid recovery simulation. ">Main.cpp</a>, resulting in N photons defocussed by <a class="el" href="class_gauss2d.html">Gauss2d</a>.</li>
<li>Changed the Poisson noise method in the <a class="el" href="class_test.html" title="Class to bin an inputted Gaussian 2d array and find its centroid. ">Test</a> class to N - (X * time * area), where X~Po(sqrt(N)). This allows photon noise to be either positive or negative.</li>
<li>Fixed the input of the star coordinates to be in terms of the pixel index.</li>
<li>Bug fixes and performance and flexibility improvements.</li>
</ul>
</li>
<li>2.1.1 2017-08-01<ul>
<li>Fixed addition of Poisson noise, where the number of photons recorded was added to the output matrix twice</li>
<li>Added parameters for various kinds of noise and inefficiencies:<ul>
<li>Emissivity, where the ideal case is e=1</li>
<li>Quantum efficiency, where ideal case is QE=0</li>
</ul>
</li>
<li>Added parameters for other noise from the <a href="https://www.e2v.com/resources/account/download-datasheet/3828" title="CCD datasheet">E2V CCD230-42 datasheet</a>:<ul>
<li>Temperature-dependent dark current, calculated from a temperature input. References:<ul>
<li>Dyer, "A phenomenological model for the Meyer-Neldel rule", <a href="http://iopscience.iop.org/article/10.1088/0022-3719/19/28/016">J. Phys. C: Solid State Phys. 19 (1986) pp. 5655-5664.</a></li>
<li>Widenhorn et al, "Temperature dependence of dark current in a CCD", <a href="http://dx.doi.org/10.1117/12.463446">Proc. SPIE 4669, Sensors and Camera Systems for Scientific, Industrial, and Digital Photography Applications III, 193 (April 26, 2002)</a></li>
</ul>
</li>
<li>Readout noise, distributed according to Poisson statistics</li>
</ul>
</li>
<li>Plotted the first real results.<ul>
<li>At 273K with noise but with ideal emissivity and quantum efficiency: <div class="image">
<img src="http://i.imgur.com/VHxvK8e.png"  alt="Levels out at sigma ~40 for magnitude &lt; 13" title="Result with noise"/>
</div>
</li>
<li>Ideal Gaussian input, with no noise of any kind: <div class="image">
<img src="http://i.imgur.com/fTqxLlr.png"  alt="Accurate for all except magnitude 15" title="Result without noise"/>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li>2.1.2 2017-08-06.<ul>
<li>Looking at the error dependent on the position of the centre within the central pixel, it seems like this dependence is greater for smaller sigma, as shown below for 10k x 10k s-pixels binned into 100x100 pixels.</li>
</ul>
</li>
<li>2.1.3 2017-08-24<ul>
<li>Notice that the E2V CCD230-42 is rated for operating temperature 153-323K. Detector to be at 72K.</li>
<li>Added ADU parameter, set as ideal 1 electron per count for now.</li>
<li>Updated some of the placeholder 0 and 1 variables in <a class="el" href="_main_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4" title="Main method. Runs tests with inputted parameters. ">main()</a> to the actual values:<ul>
<li>Detector temperature: 72K; Reference: White book p67.</li>
<li>Aperture minimum 45cm; p15 and mirror M1 diameter 45cm p18.</li>
<li>Quantum efficiency at -25C of back-illuminated E2V CCD230-42: ~0.8 with basic broadband coating at visual wavelengths.</li>
<li>Readout noise of 230-42: 8 e- RMS at -25C at 750 kHz.</li>
<li>Emissivity <a href="http://www.ctio.noao.edu/pipermail/ccd-world/2015/001366.html">seems to be 1</a>.</li>
</ul>
</li>
<li>Created block diagram of the modular code: <div class="image">
<img src="http://i.imgur.com/VbaaLUO.png"  alt="Block diagram of the code" title="Flowchart of the modular code"/>
</div>
</li>
<li>Implemented output of parameters and of photons simulated and detected.</li>
</ul>
</li>
<li>2.2.0 2017-08-26<ul>
<li>In order to run Monte Carlo simulations of the centroid determination error, the runToFile function was moved from <a class="el" href="_main_8cpp.html" title="Main method to run centroid recovery simulation. ">Main.cpp</a> into a newly-created <a class="el" href="class_monte_carlo.html">MonteCarlo</a> class. </li>
</ul>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
